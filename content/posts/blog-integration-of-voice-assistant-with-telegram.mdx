---
slug: posts/blog-integration-of-voice-assistant-with-telegram
date: "2022-11-09"
image: /blog-integration-of-voice-assistant-with-telegram/intersect_alice_telegram.png
title: Integration of Yandex Alice voice assistant with Telegram
tag: blog
---
import Typography from "@material-ui/core/Typography";

<p align="center">
  <img  width="60%" src="/blog-integration-of-voice-assistant-with-telegram/intersect_alice_telegram.png"/>
</p>


#####  Motivation
At this moment of time voice assistants are usually not used frequently. Unfortunately, despite great potential main usage scenarios 
for normal people are:

    1)	Check weather and time
    2)	Set timer/alarm
    3)	Manipulate smart devices
But for blind people they can be much more helpful. In addition to the already listed scenarios blind people also can find 
the following scenarios also useful:

    4)	Answer the question (as search engine)
    5)	Read book/play music (podcast)
    6)	Play games
These scenarios are already implemented. But you could notice that there are no scenarios for communication with other people,
 which I would say is very strange.

That is why I decided to fix this problem for my blind grandmother.
<br></br>

#####  Tools
Since my grandmother is Russian, the only option to use voice assistant is to buy Yandex Station with Alice. 
This is the only Russian speaking voice assistant at the moment. 
Also, one of killer features of it is creating custom scenarios called skills with help of API.
 It has really good integration with Yandex Cloud functions. Actually, to create “Hello World!” skill for Yandex Alice it is required only less than 15 lines of python code (excluding comments). You can find this example [here](https://cloud.yandex.com/en/docs/functions/tutorials/alice-skill).
<br></br>

##### Solution
To integrate Yandex Alice with telegram we just need to add a few lines more. Final script is 
[here](https://github.com/bakuteyev/alice_telegram/blob/main/skill.py). 
As in [previous artice](https://bakuteev.website.yandexcloud.net/posts/blog-telegram-news-filtration-aggregation) we need to create
cloud function. But this script in addition to telegram token we need tokens for Yandex Object Storage.
We heed to install [Yandex Cloud CLI](https://cloud.yandex.com/en-ru/docs/cli/quickstart).
Then to run the following command

```bash
yc iam access-key create --service-account-name {yourbucketname} \
--description "this key is for my bucket"
```

Exampe of output is on the screenshot bellow.
<br></br>
<p align="center">
  <img  width="60%" src="/blog-integration-of-voice-assistant-with-telegram/bucket_tokens.png"/>
</p>

Yandex Object Storage is S3 compatible storage. Tokens in this output directly match with standard S3 tokens.
`key_id` is `AWS_SERVER_PUBLIC_KEY` and `secret` is `AWS_SERVER_SECRET_KEY`. We need to pass these tokens as 
environment variables in our cloud function.

<br></br>
<p align="center">
  <img  width="50%" src="/blog-integration-of-voice-assistant-with-telegram/aws_tokens.png"/>
</p>

If you didn't create Object Storage you can create it now.
To configure your script you need to fill [these lines](https://github.com/bakuteyev/alice_telegram/blob/c025cd8e01931419e909a30288c04db500ccabe8/skill.py#L7)
```python
users = [] # Pass telegram ids to which you would like to send messages from voice assistant 
bucket_name = 'bucket_name' # Change for your bucket name
```
Script uses Object Storage only to check if we received new message which needs to be spoken by voice assistant or 
this message was already spoken by voice assistant.

To get your telegram ID you can use for example [@username_to_id_bot](https://t.me/username_to_id_bot). 
Also you can pass more telegram IDs, which are supposed to send and recieve messages from voice assistant.
Like in the previous article you need to create telegram bot with [@BotFather](https://t.me/BotFather).
Assign to variable `bucket_name name` of your Object Storage bucket.

<br></br>
The next very important step is to create a skill for voice assistant. You can do it on 
[this page](https://dialogs.yandex.ru/developer), just press "Create dialog" button and then "Alice skill". 
Fill required fields. Their purpose is clear from their description. 
Select your cloud function 
<br></br>
<p align="center">
  <img  width="60%" src="/blog-integration-of-voice-assistant-with-telegram/skill_function.png"/>
</p>

Choose `Access type` as `private`. If you need, also you can share your skill with other users on tab "Access".
And that should be the final step of development.


<br></br>

The workflow look like this:

    1) User of voice assistant launches the skill.
    2) User pronounces message he wants to send to telegram.
    4) User of voice assistant stops the skill.
    5) Telegram user receives the message from the bot.
    6) Telegram user replies to the message in the bot.
    7) User of the voice assistant launches the skill again and voice assistant pronounces message from the bot.


<br></br>


##### Conclusion
The following solution might be a little awkward. But it fulfills all neccenecessary requirements. 
It allows blind people send message to telegram almost with no effort at least for an emergency contact.
Unfortunately, at the moment there is no way to send notification directly to voice assistant to avoid additional request to 
check for new messages. Also, the list of contacts is restricted by the users of the bot.
